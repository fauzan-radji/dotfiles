"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const HotReloadService_1 = require("./HotReloadService");
/**
 * Enables hot reloading for the specified module or `process.mainModule` if no module is specified.
 * Dependencies of tracked modules are also tracked.
 */
function enableHotReload(options) {
    if (!HotReloadService_1.HotReloadService.instance) {
        let shouldTrack = (filename) => {
            if (/node_modules/.exec(filename)) {
                return false;
            }
            return true;
        };
        if (options && options.shouldTrack) {
            shouldTrack = options.shouldTrack;
        }
        let loggingEnabled = false;
        if (options && options.loggingEnabled !== undefined) {
            loggingEnabled = options.loggingEnabled;
        }
        HotReloadService_1.HotReloadService.instance = new HotReloadService_1.HotReloadService(loggingEnabled, shouldTrack);
    }
    if (options && options.entryModule) {
        HotReloadService_1.HotReloadService.instance.trackEntryModule(options.entryModule);
    }
    else if (process.mainModule) {
        HotReloadService_1.HotReloadService.instance.trackEntryModule(process.mainModule);
    }
    else {
        throw new Error("`process.mainModule` is not defined and no `entryModule` has been specified!");
    }
}
exports.enableHotReload = enableHotReload;
function disableHotReload() {
    if (HotReloadService_1.HotReloadService.instance) {
        HotReloadService_1.HotReloadService.instance.dispose();
        HotReloadService_1.HotReloadService.instance = undefined;
    }
}
exports.disableHotReload = disableHotReload;
//# sourceMappingURL=enableHotReload.js.map